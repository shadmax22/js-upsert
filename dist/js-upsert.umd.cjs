(function(s,l){typeof exports=="object"&&typeof module<"u"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(s=typeof globalThis<"u"?globalThis:s||self,l(s["js-upsert"]={}))})(this,function(s){"use strict";function l(t,e=null){return{"$$@@@@__upsert_hook":{value:t,index:e,isFunction:typeof t=="function"}}}function i({obj:t},e,u=[],o=!1){let n=[];for(let r in t){let f=t[r];if(r===e&&(f??!1))n.push({index:[...u,...f.index??[]],value:f.value,isFunction:f.isFunction});else if(typeof f=="object"){const h=i({obj:f},e,[...u,r],!0);n=n.concat(h.obj)}}return o?{obj:n}:{result:n}}function p(t,e,u,o=!1){if(e.length==1)return t[e[0]]=o?u(t[e[0]]):u,t;let n=(t??[])[e[0]]??!1;if(!n){let r=c(e,u,o);return t[e[0]]=r,t}return e.shift(),p(n,e,u,o)}function c(t,e,u=!1){let o=[...t],n;return o.length==1?n=u?e({}):e:(n={},o.shift(),n[o[0]]=c(o,e)),n}function b(t,e,u={returnType:"object"}){let{result:o}=i({obj:e},"$$@@@@__upsert_hook");for(let n=0;n<o.length;n++){let r=o[n];p(t,r.index,r.value,r.isFunction)}return((u==null?void 0:u.returnType)??"object")=="object"?{...t}:[...t]}s.set=l,s.upsert=b,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
