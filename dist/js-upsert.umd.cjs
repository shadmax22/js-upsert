(function(l,s){typeof exports=="object"&&typeof module<"u"?s(exports):typeof define=="function"&&define.amd?define(["exports"],s):(l=typeof globalThis<"u"?globalThis:l||self,s(l["js-upsert"]={}))})(this,function(l){"use strict";function s(e,t=null){return{["$$@@@@__upsert_hook_"+Math.floor(Math.random()*100)]:{value:e,index:t,isFunction:typeof e=="function"}}}function p({obj:e},t,o=[],r=!1){let n=[];for(let f in e){let u=e[f];if(f.includes(t)&&(u??!1))n.push({index:[...o,...u.index??[]],value:u.value,isFunction:u.isFunction});else if(typeof u=="object"){const b=p({obj:u},t,[...o,f],!0);n=n.concat(b.obj)}}return r?{obj:n}:{result:n}}function i(e,t,o,r=!1){if(t.length<=1)return t[0]??!1?e[t[0]]=r?o(e[t[0]??t]):o:e=r?o(e):o,e;let n=(e??[])[t[0]]??!1;if(!n){let f=c(t,o,r);return e[t[0]]=f,e}return t.shift(),i(n,t,o,r)}function c(e,t,o=!1){let r=[...e],n;return r.length==1?n=o?t({}):t:(n={},r.shift(),n[r[0]]=c(r,t)),n}function h(e,t,o={returnType:"object"}){let{result:r}=p({obj:t},"$$@@@@__upsert_hook");for(let n=0;n<r.length;n++){let f=r[n];f.index.length==0?e=i(e,f.index,f.value,f.isFunction):i(e,f.index,f.value,f.isFunction)}return((o==null?void 0:o.returnType)??"object")=="object"?{...e}:[...e]}l.set=s,l.upsert=h,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
