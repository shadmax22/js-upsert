(function(l,i){typeof exports=="object"&&typeof module<"u"?i(exports):typeof define=="function"&&define.amd?define(["exports"],i):(l=typeof globalThis<"u"?globalThis:l||self,i(l["j-upsert"]={}))})(this,function(l){"use strict";function i(e,t=null){return{"$$@@@@__upsert_hook":{value:e,index:t}}}function o({obj:e},t,n=[],u=!1){let f=[];for(let r in e)if(r===t&&(e[r]??!1))f.push({index:[...n,...e[r].index??[]],value:e[r].value});else if(typeof e[r]=="object"){const h=o({obj:e[r]},t,[...n,r],!0);f=f.concat(h.obj)}return u?{obj:f}:{result:f}}function s(e,t,n){if(t.length==1)return e[t[0]]=n,e;let u=(e??[])[t[0]]??!1;if(!u){let f=p(t,n);return e[t[0]]=f,e}return t.shift(),s(u,t,n)}function p(e,t){let n=[...e],u;return n.length==1?u=t:(u={},n.shift(),u[n[0]]=p(n,t)),u}function c(e,t){let{result:n}=o({obj:t},"$$@@@@__upsert_hook");for(let u=0;u<n.length;u++){let f=n[u];s(e,f.index,f.value)}return e}l.set=i,l.upsert=c,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
